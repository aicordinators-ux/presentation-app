<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ØµÙ…Ù… Ø¨Ø±Ø²Ù†ØªÙŠØ´Ù† â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ù…ÙØ­Ø¯Ù‘Ø«)</title>
  <style>
    body { font-family: "Cairo", sans-serif; background: #f7f7f7; text-align: center; padding: 18px; color:#222 }
    h2 { margin-bottom: 12px; }
    input, textarea, select { width: 90%; padding: 8px; margin: 6px 0; border-radius: 6px; border: 1px solid #ccc; text-align: center; }
    button { padding: 10px 18px; border: none; border-radius: 8px; cursor: pointer; margin: 8px; }
    #exportButton { background: #007bff; color: white; }
    #testFetch { background: #28a745; color: white; }
    #imageContainer { margin-top: 8px; }
    .image-box { display:inline-block; width:250px; height:150px; border:2px dashed #ccc; border-radius:12px; margin:8px; vertical-align:top; background:#eef3ff; overflow:hidden; cursor:pointer; position:relative; }
    .image-box span { display:block; line-height:150px; color:#555; }
    .image-box img{ width:100%; height:100%; object-fit:cover; border-radius:12px; display:block;}
    .status { margin-top:8px; font-size:14px; color:#444; }
    .modal { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,0.35); }
    .modal .card { background:white; padding:16px; border-radius:10px; width:320px; text-align:center; }
    .small { font-size:13px; color:#666; }
    .disabled { opacity:0.6; pointer-events:none; }
  </style>
</head>
<body>

  <h2>Ù…ØµÙ…Ù… Ø¨Ø±Ø²Ù†ØªÙŠØ´Ù† â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ (Ù…Ø­Ø¯Ù‘Ø«)</h2>

  <div>
    <button id="addSlide">â• Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ (Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ)</button>
    <button id="exportButton">ğŸ§¾ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶</button>
  </div>

  <div>
    <label>Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù€ Google Sheet (Sheet ID)</label><br>
    <input id="sheetId" placeholder="Ø§Ù†Ø³Ø® Ø§Ù„Ù€ ID Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„Ø´ÙŠØª: /d/THIS_IS_ID/" />
    <div class="small">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø§Ø²Ù… Ø§Ù„Ø´ÙŠØª Ù…ÙØ´Ø§Ø±Ùƒ Ù„Ù„Ø¹Ø§Ù…Ø© Ø£Ùˆ Ù…Ù†Ø´ÙˆØ± (Publish to web).</div>
    <button id="testFetch">ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´ÙŠØª</button>
  </div>

  <div style="margin-top:10px">
    <label>Merch Code</label><br>
    <input type="text" id="merchCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Enter Ø£Ùˆ Ø§Ø®ØªØ¨Ø±" autocomplete="off">
  </div>

  <div>
    <label>Acc-Code</label><br>
    <input type="text" id="accCode" readonly>
  </div>

  <div>
    <label>Customer Name</label><br>
    <input type="text" id="customerName" readonly>
  </div>

  <div>
    <label>Address</label><br>
    <input type="text" id="address" readonly>
  </div>

  <div>
    <label>Customer Type</label><br>
    <input type="text" id="customerType" readonly>
  </div>

  <div>
    <label>Gov.</label><br>
    <input type="text" id="gov" readonly>
  </div>

  <div>
    <label>Notes</label><br>
    <textarea id="notes" rows="2"></textarea>
  </div>

  <div id="imageContainer">
    <div class="image-box" data-index="0"><span>Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©</span></div>
    <div class="image-box" data-index="1"><span>Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©</span></div>
    <div class="image-box" data-index="2"><span>Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©</span></div>
  </div>

  <p class="status" id="status">Ø¬Ø§Ù‡Ø².</p>

  <!-- Modal Ù„Ø§Ø®ØªÙŠØ§Ø± ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ùˆ Ù…Ø¹Ø±Ø¶ -->
  <div id="chooserModal" style="display:none" class="modal">
    <div class="card">
      <h3>Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„ØµÙˆØ±Ø©</h3>
      <button id="useCamera" style="background:#007bff;color:#fff;padding:8px 12px;border-radius:6px;margin:6px">Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© (ÙƒØ§Ù…ÙŠØ±Ø§)</button>
      <button id="useGallery" style="background:#6c757d;color:#fff;padding:8px 12px;border-radius:6px;margin:6px">Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù…Ø¹Ø±Ø¶</button>
      <div style="margin-top:8px"><button id="closeChooser">Ø¥Ù„ØºØ§Ø¡</button></div>
    </div>
  </div>

  <!-- Ù…ÙƒØªØ¨Ø© PPTXGenJS -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.9.0/dist/pptxgen.min.js"></script>

  <script>
    // ---------- Ø¹Ù†Ø§ØµØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ----------
    const sheetIdInput = document.getElementById('sheetId');
    const testFetchBtn = document.getElementById('testFetch');
    const merchInput = document.getElementById('merchCode');
    const status = document.getElementById('status');
    const exportBtn = document.getElementById('exportButton');

    // Image boxes state
    const imageBoxes = Array.from(document.querySelectorAll('.image-box'));
    let activeBoxIndex = null; // index of box user clicked (for modal)

    // Cached sheet rows after successful fetch
    let sheetRows = null;

    // ---------- Helpers ----------
    function setStatus(msg, isError = false) {
      status.textContent = msg;
      status.style.color = isError ? 'crimson' : '#222';
      console.log('[STATUS]', msg);
    }

    function parseGvizJson(text) {
      // gviz JSON wrapper: "/*O_o*/\ngoogle.visualization.Query.setResponse(...)"
      try {
        const json = JSON.parse(text.substr(47).slice(0, -2));
        return json.table.rows;
      } catch (err) {
        console.error('GVIZ parse error', err);
        throw new Error('ØªØ¹Ø°Ø± ØªØ­Ù„ÙŠÙ„ Ù†Ø§ØªØ¬ Ø§Ù„Ù€ Google Sheets (GVIZ). ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù€ Sheet Ù…Ù†Ø´ÙˆØ± Ø£Ùˆ Ù…ÙØ´Ø§Ø±Ùƒ.');
      }
    }

    // ---------- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´ÙŠØª ----------
    async function fetchSheet(sheetId) {
      if (!sheetId) throw new Error('Ø§Ø¯Ø®Ù„ Sheet ID Ø£ÙˆÙ„Ø§Ù‹.');
      // GVIZ endpoint (works if sheet is viewable for anyone)
      const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;
      setStatus('Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´ÙŠØª...');
      const res = await fetch(url);
      if (!res.ok) throw new Error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø´ÙŠØª. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ ID ÙˆØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©.');
      const text = await res.text();
      const rows = parseGvizJson(text);
      setStatus('ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø´ÙŠØª (' + rows.length + ' ØµÙ).');
      return rows;
    }

    // ØªØ­ÙˆÙŠÙ„ ØµÙÙˆÙ Ø§Ù„Ø´ÙŠØª Ø¥Ù„Ù‰ Ù‡ÙŠÙƒÙ„ Ø£Ø¨Ø³Ø· (ÙƒÙ„ ØµÙ ÙƒÙ…ØµÙÙˆÙØ© Ù‚ÙŠÙ…)
    function normalizeRows(rows) {
      return rows.map(r => (r.c || []).map(cell => (cell ? cell.v : '')));
    }

    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† merch code
    function findByMerch(code) {
      if (!sheetRows) return null;
      const normalized = normalizeRows(sheetRows);
      // Ù†ÙØªØ±Ø¶ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„ Ù‡Ùˆ Merch CodeØŒ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ accCodeØŒ Ø§Ù„Ø«Ø§Ù„Ø« customerName, Ø§Ù„Ø±Ø§Ø¨Ø¹ address, Ø§Ù„Ø®Ø§Ù…Ø³ customerType, Ø§Ù„Ø³Ø§Ø¯Ø³ gov
      for (let r of normalized) {
        if (r[0] != null && String(r[0]).trim() === String(code).trim()) {
          return {
            accCode: r[1] || '',
            customerName: r[2] || '',
            address: r[3] || '',
            customerType: r[4] || '',
            gov: r[5] || ''
          };
        }
      }
      return null;
    }

    // ---------- Ø²Ø± Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù„Ø¨ Ø§Ù„Ø´ÙŠØª ----------
    testFetchBtn.addEventListener('click', async () => {
      try {
        sheetRows = null;
        const id = sheetIdInput.value.trim();
        if (!id) { setStatus('Ø§Ø¯Ø®Ù„ Sheet ID ÙÙŠ Ø§Ù„Ø­Ù‚Ù„ Ø£Ø¹Ù„Ø§Ù‡.', true); return; }
        sheetRows = await fetchSheet(id);
      } catch (err) {
        console.error(err);
        setStatus(err.message || 'ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø´ÙŠØª.', true);
      }
    });

    // Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¶ØºØ· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Enter ÙÙŠ Ø®Ø§Ù†Ø© Merch Code -> Ù†Ø¨Ø­Ø«
    merchInput.addEventListener('keydown', async (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        await lookupMerch();
      }
    });

    async function lookupMerch() {
      const code = merchInput.value.trim();
      if (!code) { setStatus('Ø£Ø¯Ø®Ù„ Merch Code Ø«Ù… Ø§Ø¶ØºØ· Enter.', true); return; }
      try {
        // Ù„Ùˆ sheetRows Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ Ù†Ø­Ø§ÙˆÙ„ Ø¬Ù„Ø¨Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¶Ø¹ ID)
        if (!sheetRows) {
          const id = sheetIdInput.value.trim();
          if (!id) { setStatus('Ø§Ø¯Ø®Ù„ Sheet ID Ø£ÙˆÙ„Ø§Ù‹ Ø£Ùˆ Ø§Ø¶ØºØ· Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù„Ø¨ Ø§Ù„Ø´ÙŠØª.', true); return; }
          sheetRows = await fetchSheet(id);
        }
        const found = findByMerch(code);
        if (!found) {
          setStatus('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø§Ù„Ø´ÙŠØª.', true);
          // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
          document.getElementById('accCode').value = '';
          document.getElementById('customerName').value = '';
          document.getElementById('address').value = '';
          document.getElementById('customerType').value = '';
          document.getElementById('gov').value = '';
          return;
        }
        // Ø¹ÙØ¨Ù‘ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
        document.getElementById('accCode').value = found.accCode;
        document.getElementById('customerName').value = found.customerName;
        document.getElementById('address').value = found.address;
        document.getElementById('customerType').value = found.customerType;
        document.getElementById('gov').value = found.gov;
        setStatus('ØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª.');
        saveData();
      } catch (err) {
        console.error(err);
        setStatus(err.message || 'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙˆØ¯.', true);
      }
    }

    // ---------- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±: Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ù„ÙŠØ®ØªØ§Ø± ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ùˆ Ù…Ø¹Ø±Ø¶ ----------
    const chooserModal = document.getElementById('chooserModal');
    const useCameraBtn = document.getElementById('useCamera');
    const useGalleryBtn = document.getElementById('useGallery');
    const closeChooser = document.getElementById('closeChooser');

    imageBoxes.forEach(box => {
      box.addEventListener('click', (e) => {
        activeBoxIndex = parseInt(box.getAttribute('data-index'), 10);
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±
        chooserModal.style.display = 'flex';
      });
    });

    closeChooser.addEventListener('click', () => {
      chooserModal.style.display = 'none';
      activeBoxIndex = null;
    });

    // Ø¯Ø§Ù„Ø© Ù„ÙØªØ­ input Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
    function openFileInput({ useCamera = false }) {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = 'image/*';
      // Ù„Ùˆ Ø§Ø®ØªØ±Ù†Ø§ ÙƒØ§Ù…ÙŠØ±Ø§ Ù†Ø¶Ø¹ capture (Ù‡Ø°Ø§ Ø³ÙŠØ·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ù‚ÙˆØ©) â€” Ù‡Ù†Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ø®ØªØ§Ø± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ù†ÙØ³Ù‡
      if (useCamera) {
        input.setAttribute('capture', 'environment'); // Ø£Ùˆ 'user' Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©
      } else {
        input.removeAttribute('capture');
      }

      input.onchange = (ev) => {
        const file = ev.target.files && ev.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (r) => {
          const src = r.target.result;
          const box = imageBoxes[activeBoxIndex];
          if (box) box.innerHTML = `<img src="${src}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„">`;
          saveData();
        };
        reader.readAsDataURL(file);
      };

      // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø±
      input.click();
    }

    useCameraBtn.addEventListener('click', () => {
      chooserModal.style.display = 'none';
      if (activeBoxIndex === null) return;
      openFileInput({ useCamera: true });
      activeBoxIndex = null;
    });

    useGalleryBtn.addEventListener('click', () => {
      chooserModal.style.display = 'none';
      if (activeBoxIndex === null) return;
      openFileInput({ useCamera: false });
      activeBoxIndex = null;
    });

    // ---------- Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙˆØ§Ø³ØªØ±Ø¬Ø§Ø¹ ----------
    const fields = ["merchCode", "accCode", "customerName", "address", "customerType", "gov", "notes"];
    function saveData() {
      try {
        const data = {};
        fields.forEach(id => data[id] = document.getElementById(id).value);
        const images = [];
        document.querySelectorAll('.image-box img').forEach(img => images.push(img.src));
        data.images = images;
        localStorage.setItem('presentationData_v2', JSON.stringify(data));
        setStatus('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠÙ‹Ø§.');
      } catch (err) {
        console.error('save error', err);
      }
    }

    function loadData() {
      const saved = localStorage.getItem('presentationData_v2');
      if (!saved) return;
      try {
        const data = JSON.parse(saved);
        fields.forEach(id => { if (data[id]) document.getElementById(id).value = data[id]; });
        if (data.images && Array.isArray(data.images)) {
          data.images.forEach((src,i) => {
            const box = imageBoxes[i];
            if (box && src) box.innerHTML = `<img src="${src}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„">`;
          });
        }
        setStatus('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©.');
      } catch (err) { console.error('load error', err); }
    }

    window.addEventListener('load', loadData);
    fields.forEach(id => document.getElementById(id).addEventListener('input', saveData));

    // ---------- ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ (pptx) ----------
    exportBtn.addEventListener('click', async () => {
      try {
        exportBtn.classList.add('disabled');
        exportBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...';
        setStatus('ÙŠØªÙ… ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„ØªØµØ¯ÙŠØ±...');

        const merchCode = document.getElementById('merchCode').value || '';
        const accCode = document.getElementById('accCode').value || '';
        const customerName = document.getElementById('customerName').value || '';
        const address = document.getElementById('address').value || '';
        const customerType = document.getElementById('customerType').value || '';
        const gov = document.getElementById('gov').value || '';
        const notes = document.getElementById('notes').value || '';

        if (!merchCode && !customerName) {
          setStatus('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±.', true);
          exportBtn.classList.remove('disabled');
          exportBtn.textContent = 'ğŸ§¾ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶';
          return;
        }

        const pptx = new PptxGenJS();
        pptx.layout = 'LAYOUT_WIDE'; // 16x9

        // Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        const slide = pptx.addSlide();
        slide.addText('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„', { x:1, y:0.4, fontSize:28, bold:true, color:'003366' });

        const info = [
          `Merch Code: ${merchCode}`,
          `Acc-Code: ${accCode}`,
          `Customer Name: ${customerName}`,
          `Address: ${address}`,
          `Customer Type: ${customerType}`,
          `Gov: ${gov}`,
          `Notes: ${notes}`
        ];

        let y = 1.2;
        info.forEach(line => {
          slide.addText(line, { x:1, y, fontSize:16, color:'000000' });
          y += 0.5;
        });

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ± ÙƒÙ„ ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Ø³Ù„Ø§ÙŠØ¯ Ù…Ù†ÙØµÙ„
        const imgs = Array.from(document.querySelectorAll('.image-box img')).map(i=>i.src).filter(Boolean);
        for (let i=0;i<imgs.length;i++) {
          const s = pptx.addSlide();
          // Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ØªÙ‚Ø±ÙŠØ¨ÙŠØŒ PPTXGen ÙŠØªÙ‚Ø¨Ù„ dataURL
          s.addImage({ data: imgs[i], x:0.4, y:0.4, w:9, h:5 });
          s.addText(`ØµÙˆØ±Ø© ${i+1}`, { x:4, y:5.6, fontSize:14, color:'444444' });
        }

        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù (await Ù„Ø¶Ù…Ø§Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©)
        const filename = `presentation_${merchCode || 'client'}.pptx`;
        await pptx.writeFile({ fileName: filename });
        setStatus('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶: ' + filename);
      } catch (err) {
        console.error('export error', err);
        setStatus('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØµØ¯ÙŠØ±. Ø§ÙØªØ­ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„.', true);
        alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ± â€” ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙˆØ± ØµØ§Ù„Ø­Ø© Ø£Ùˆ Ø§ÙØªØ­ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„.');
      } finally {
        exportBtn.classList.remove('disabled');
        exportBtn.textContent = 'ğŸ§¾ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶';
      }
    });

    // Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ (Ù…Ø­Ù„Ù‘ÙŠ â€” Ù…Ø¬Ø±Ø¯ Ù…Ø«Ø§Ù„ ØªÙˆØ³ÙŠØ¹ÙŠ Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ)
    document.getElementById('addSlide').addEventListener('click', () => {
      alert('Ù…ÙŠØ²Ø© Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù…Ù†ÙØµÙ„ Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§ Ù„Ùˆ Ø­Ø¨ÙŠØª. Ø¯Ù„ÙˆÙ‚ØªÙŠ Ø§Ù„ØªØµØ¯ÙŠØ± ÙŠÙ†Ø´Ø¦ Ø³Ù„Ø§ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª + Ø³Ù„Ø§ÙŠØ¯ Ù„ÙƒÙ„ ØµÙˆØ±Ø©.');
    });

    // Ø´ØºÙ‘Ù„ Ø§Ù„Ø¨Ø­Ø« Ù„Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙƒØªØ¨ ÙƒÙˆØ¯ ÙˆØºØ§Ø¯Ø± Ø§Ù„Ø®Ø§Ù†Ø©
    merchInput.addEventListener('blur', () => { /* Ø§Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙÙ‚Ø· */ saveData(); });

  </script>
</body>
</html>
