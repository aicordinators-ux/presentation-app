<!doctype html>
<html lang="ar" dir="rtl">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Ù…ØµÙ…Ù… Ø¨Ø±Ø²Ù†ØªÙŠØ´Ù† Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</title>
Â  <script src="https://unpkg.com/pptxgenjs@3.9.0/dist/pptxgen.bundle.js"></script>
Â  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
Â  <style>
Â  Â  /* Ù†ÙØ³ Ø§Ù„Ù€ CSS Ø§Ù„Ø³Ø§Ø¨Ù‚ */
Â  Â  :root {
Â  Â  Â  --bg: #f7f7f8;
Â  Â  Â  --card: #fff;
Â  Â  Â  --accent: #0b71eb;
Â  Â  Â  --muted: #666;
Â  Â  Â  --error: #e53935;
Â  Â  Â  --success: #43a047;
Â  Â  Â  --secondary: #2c8a2c;
Â  Â  }
Â  Â Â 
Â  Â  html, body {
Â  Â  Â  height: 100%;
Â  Â  Â  margin: 0;
Â  Â  Â  font-family: Tahoma, Arial, sans-serif;
Â  Â  Â  background: var(--bg);
Â  Â  Â  color: #111;
Â  Â  }
Â  Â Â 
Â  Â  .app {
Â  Â  Â  max-width: 980px;
Â  Â  Â  margin: 12px auto;
Â  Â  Â  padding: 14px;
Â  Â  }
Â  Â Â 
Â  Â  header {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  gap: 12px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â Â 
Â  Â  h1 {
Â  Â  Â  font-size: 18px;
Â  Â  Â  margin: 0;
Â  Â  }
Â  Â Â 
Â  Â  .controls {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 8px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  }
Â  Â Â 
Â  Â  button {
Â  Â  Â  background: var(--accent);
Â  Â  Â  color: #fff;
Â  Â  Â  border: none;
Â  Â  Â  padding: 10px 12px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.2s;
Â  Â  Â  font-size: 14px;
Â  Â  }
Â  Â Â 
Â  Â  button:hover {
Â  Â  Â  background: #095ac5;
Â  Â  }
Â  Â Â 
Â  Â  button.secondary {
Â  Â  Â  background: var(--secondary);
Â  Â  }
Â  Â Â 
Â  Â  button.secondary:hover {
Â  Â  Â  background: #247a24;
Â  Â  }
Â  Â Â 
Â  Â  button.ghost {
Â  Â  Â  background: transparent;
Â  Â  Â  color: var(--accent);
Â  Â  Â  border: 1px solid rgba(11, 113, 235, 0.15);
Â  Â  }
Â  Â Â 
Â  Â  button.ghost:hover {
Â  Â  Â  background: rgba(11, 113, 235, 0.05);
Â  Â  }
Â  Â Â 
Â  Â  button:disabled {
Â  Â  Â  background: #ccc;
Â  Â  Â  cursor: not-allowed;
Â  Â  }
Â  Â Â 
Â  Â  main {
Â  Â  Â  margin-top: 12px;
Â  Â  }
Â  Â Â 
Â  Â  .slide-area {
Â  Â  Â  background: var(--card);
Â  Â  Â  padding: 12px;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  box-shadow: 0 6px 18px rgba(10, 10, 10, 0.04);
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â Â 
Â  Â  .placeholders {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(3, 1fr);
Â  Â  Â  gap: 12px;
Â  Â  }
Â  Â Â 
Â  Â  .ph {
Â  Â  Â  position: relative;
Â  Â  Â  padding-top: 56.25%;
Â  Â  Â  background: linear-gradient(180deg, #eef2ff, #fff);
Â  Â  Â  border-radius: 8px;
Â  Â  Â  border: 2px dashed rgba(0, 0, 0, 0.06);
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  overflow: hidden;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: border-color 0.2s;
Â  Â  }
Â  Â Â 
Â  Â  .ph:hover {
Â  Â  Â  border-color: var(--accent);
Â  Â  }
Â  Â Â 
Â  Â  .ph img {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  object-fit: cover;
Â  Â  }
Â  Â Â 
Â  Â  .ph .label {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  right: 0;
Â  Â  Â  bottom: 0;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  color: var(--muted);
Â  Â  Â  font-size: 13px;
Â  Â  Â  text-align: center;
Â  Â  Â  padding: 4px;
Â  Â  }
Â  Â Â 
Â  Â  .small {
Â  Â  Â  font-size: 13px;
Â  Â  Â  color: var(--muted);
Â  Â  Â  margin-top: 10px;
Â  Â  }
Â  Â Â 
Â  Â  input[type="text"] {
Â  Â  Â  padding: 8px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  border: 1px solid #ccc;
Â  Â  Â  font-size: 14px;
Â  Â  Â  width: 100%;
Â  Â  Â  box-sizing: border-box;
Â  Â  }
Â  Â Â 
Â  Â  input[type="text"]:disabled {
Â  Â  Â  background-color: #f5f5f5;
Â  Â  Â  color: #999;
Â  Â  }
Â  Â Â 
Â  Â  .form-grid {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
Â  Â  Â  gap: 8px;
Â  Â  Â  margin-top: 10px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  background: var(--card);
Â  Â  Â  padding: 15px;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
Â  Â  }
Â  Â Â 
Â  Â  .form-grid div {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â Â 
Â  Â  .form-grid label {
Â  Â  Â  font-size: 12px;
Â  Â  Â  margin-bottom: 4px;
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â Â 
Â  Â  .slides-list {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  Â  margin-top: 10px;
Â  Â  }
Â  Â Â 
Â  Â  .slide-thumb {
Â  Â  Â  background: var(--card);
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  border: 1px solid #eee;
Â  Â  Â  transition: all 0.2s;
Â  Â  Â  font-size: 13px;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â Â 
Â  Â  .slide-thumb:hover {
Â  Â  Â  border-color: var(--accent);
Â  Â  }
Â  Â Â 
Â  Â  .slide-thumb.active {
Â  Â  Â  background: var(--accent);
Â  Â  Â  color: white;
Â  Â  }
Â  Â Â 
Â  Â  .slide-customer {
Â  Â  Â  font-size: 10px;
Â  Â  Â  margin-top: 2px;
Â  Â  Â  opacity: 0.8;
Â  Â  }
Â  Â Â 
Â  Â  footer {
Â  Â  Â  margin-top: 20px;
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â Â 
Â  Â  .toast {
Â  Â  Â  display: none;
Â  Â  Â  position: fixed;
Â  Â  Â  bottom: 20px;
Â  Â  Â  right: 20px;
Â  Â  Â  background: var(--accent);
Â  Â  Â  color: #fff;
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-size: 14px;
Â  Â  Â  z-index: 1000;
Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
Â  Â  }
Â  Â Â 
Â  Â  .toast.error {
Â  Â  Â  background: var(--error);
Â  Â  }
Â  Â Â 
Â  Â  .toast.success {
Â  Â  Â  background: var(--success);
Â  Â  }
Â  Â Â 
Â  Â  .toast.warning {
Â  Â  Â  background: #ff9800;
Â  Â  }
Â  Â Â 
Â  Â  .modal {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  background: rgba(0, 0, 0, 0.5);
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  z-index: 1001;
Â  Â  }
Â  Â Â 
Â  Â  .modal-content {
Â  Â  Â  background: #fff;
Â  Â  Â  padding: 20px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  text-align: center;
Â  Â  Â  min-width: 280px;
Â  Â  Â  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
Â  Â  }
Â  Â Â 
Â  Â  .modal-buttons {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 8px;
Â  Â  Â  justify-content: center;
Â  Â  Â  margin-top: 15px;
Â  Â  }
Â  Â Â 
Â  Â  .data-source {
Â  Â  Â  background: #e8f5e8;
Â  Â  Â  padding: 10px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  margin-top: 10px;
Â  Â  Â  border: 1px solid #c8e6c9;
Â  Â  Â  font-size: 12px;
Â  Â  }
Â  Â Â 
Â  Â  .customer-info {
Â  Â  Â  background: #e8f0fe;
Â  Â  Â  padding: 10px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  margin-top: 10px;
Â  Â  Â  border: 1px solid #bbdefb;
Â  Â  Â  font-size: 12px;
Â  Â  }
Â  Â Â 
Â  Â  .loading-overlay {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  background: rgba(255, 255, 255, 0.8);
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  z-index: 9999;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â Â 
Â  Â  .loading-spinner {
Â  Â  Â  width: 40px;
Â  Â  Â  height: 40px;
Â  Â  Â  border: 4px solid #f3f3f3;
Â  Â  Â  border-top: 4px solid var(--accent);
Â  Â  Â  border-radius: 50%;
Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  Â  margin-bottom: 10px;
Â  Â  }
Â  Â Â 
Â  Â  @keyframes spin {
Â  Â  Â  0% { transform: rotate(0deg); }
Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  }
Â  Â Â 
Â  Â  .data-status {
Â  Â  Â  background: #fff3cd;
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  border: 1px solid #ffeaa7;
Â  Â  Â  font-size: 12px;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: space-between;
Â  Â  }
Â  Â Â 
Â  Â  .data-status.success {
Â  Â  Â  background: #d1edff;
Â  Â  Â  border-color: #b3d9ff;
Â  Â  }
Â  Â Â 
Â  Â  .data-status.error {
Â  Â  Â  background: #ffeaea;
Â  Â  Â  border-color: #ffcccc;
Â  Â  }
Â  Â Â 
Â  Â  @media (max-width: 768px) {
Â  Â  Â  .placeholders {
Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  .form-grid {
Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  header {
Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  align-items: flex-start;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  .controls {
Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  button {
Â  Â  Â  Â  padding: 8px 10px;
Â  Â  Â  Â  font-size: 13px;
Â  Â  Â  }
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="app">
Â  Â  Â  Â  <div class="data-status" id="dataStatus">
Â  Â  Â  <span id="statusText">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡...</span>
Â  Â  Â  <button id="retryLoadBtn" class="ghost" style="display: none; font-size: 12px; padding: 4px 8px;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
Â  Â  </div>
Â  Â Â 
Â  Â  <header>
Â  Â  Â  <h1>Ù…ØµÙ…Ù… Ø¨Ø±Ø²Ù†ØªÙŠØ´Ù† â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h1>
Â  Â  Â  <div class="controls">
Â  Â  Â  Â  <button id="addSlideBtn" disabled>â• Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù„Ù†ÙØ³ Ø§Ù„Ø¹Ù…ÙŠÙ„ </button>
Â  Â  Â  Â  <button id="addSlideForNewCustomerBtn" class="secondary" disabled>â• Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù„Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
Â  Â  Â  Â  <button id="exportBtn" disabled>ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶</button>
Â  Â  Â  Â  <button id="refreshDataBtn" class="ghost">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
Â  Â  Â  </div>
Â  Â  </header>

Â  Â  <div class="customer-info" id="customerInfo" style="display: none;">
Â  Â  Â  <strong>Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong> <span id="currentCustomerName">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>
Â  Â  Â  <div style="margin-top: 5px; font-size: 11px; color: #666;">
Â  Â  Â  Â  ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„: <span id="currentCustomerCode">ØºÙŠØ± Ù…Ø­Ø¯Ø¯</span>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <section class="form-grid">
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="merchCode">Merch Code</label>
Â  Â  Â  Â  <input type="text" id="merchCode" placeholder="Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª..." disabled>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="accCode">Acc-Code</label>
Â  Â  Â  Â  <input type="text" id="accCode" readonly>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="custName">Customer Name</label>
Â  Â  Â  Â  <input type="text" id="custName" readonly>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="custAddress">Address</label>
Â  Â  Â  Â  <input type="text" id="custAddress" readonly>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="custType">Customer Type</label>
Â  Â  Â  Â  <input type="text" id="custType" readonly>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="custGov">Gov.</label>
Â  Â  Â  Â  <input type="text" id="custGov" readonly>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <label for="notes">Notes</label>
Â  Â  Â  Â  <input type="text" id="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©" disabled>
Â  Â  Â  </div>
Â  Â  </section>

Â  Â  <main>
Â  Â  Â  <section class="slide-area">
Â  Â  Â  Â  <div class="placeholders" id="placeholders"></div>
Â  Â  Â  Â  <div class="small">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…Ø±Ø¨Ø¹ Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø£Ùˆ Ø§Ù„Ù…Ø¹Ø±Ø¶.</div>
Â  Â  Â  </section>
Â  Â  Â  <div class="small">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª:</div>
Â  Â  Â  <div class="slides-list" id="slidesList"></div>
Â  Â  Â  <input type="file" id="hiddenFileInput" accept="image/*" style="display:none" />
Â  Â  </main>

Â  Â  <footer>
Â  Â  Â  <div class="small">Ø§Ù„ØµÙˆØ± Ø³ÙŠØªÙ… Ø¶ØºØ·Ù‡Ø§ Ø¥Ù„Ù‰ 600px Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø¬Ù….</div>
Â  Â  Â  <div>
Â  Â  Â  Â  <button id="clearBtn" class="ghost" disabled>ğŸ—‘ï¸ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª</button>
Â  Â  Â  </div>
Â  Â  </footer>
Â  </div>

Â  <div class="toast" id="toast"></div>

Â  <script>
Â  Â  let excelData = [];
Â  Â  // ØªØºÙŠÙŠØ± Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø­ÙØ¸ ÙƒÙ„ Ø³Ù„Ø§ÙŠØ¯ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡Ø§
Â  Â  let slides = [{
Â  Â  Â  images: [null, null, null],
Â  Â  Â  customerData: {
Â  Â  Â  Â  merchCode: '',
Â  Â  Â  Â  accCode: '',
Â  Â  Â  Â  custName: '',
Â  Â  Â  Â  custAddress: '',
Â  Â  Â  Â  custType: '',
Â  Â  Â  Â  custGov: '',
Â  Â  Â  Â  notes: ''
Â  Â  Â  }
Â  Â  }];
Â  Â  let currentIndex = 0;
Â  Â  const MAX_WIDTH = 600;
Â  Â  const placeholdersEl = document.getElementById('placeholders');
Â  Â  const slidesListEl = document.getElementById('slidesList');
Â  Â  const hiddenInput = document.getElementById('hiddenFileInput');
Â  Â  const toast = document.getElementById('toast');
Â  Â  let pendingIdx = 0;
Â  Â  let currentCustomerCode = '';
Â  Â  let hasUnsavedChanges = false;
Â  Â  let isDataLoaded = false;

Â  Â  // ÙˆØ¸ÙŠÙØ© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
Â  Â  function showToast(msg, type = 'info', time = 3000) {
Â  Â  Â  toast.textContent = msg;
Â  Â  Â  toast.className = 'toast ' + type;
Â  Â  Â  toast.style.display = 'block';
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  toast.style.display = 'none';
Â  Â  Â  }, time);
Â  Â  }

Â  Â  // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Â  Â  function updateDataStatus(status, message) {
Â  Â  Â  const dataStatus = document.getElementById('dataStatus');
Â  Â  Â  const statusText = document.getElementById('statusText');
Â  Â  Â Â 
Â  Â  Â  statusText.textContent = message;
Â  Â  Â  dataStatus.className = 'data-status';
Â  Â  Â Â 
Â  Â  Â  if (status === 'loading') {
Â  Â  Â  Â  dataStatus.classList.add('loading');
Â  Â  Â  } else if (status === 'success') {
Â  Â  Â  Â  dataStatus.classList.add('success');
Â  Â  Â  } else if (status === 'error') {
Â  Â  Â  Â  dataStatus.classList.add('error');
Â  Â  Â  }
Â  Â  }

Â  Â  // ØªÙ…ÙƒÙŠÙ†/ØªØ¹Ø·ÙŠÙ„ Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
Â  Â  function toggleUIElements(enabled) {
Â  Â  Â  document.getElementById('merchCode').disabled = !enabled;
Â  Â  Â  document.getElementById('notes').disabled = !enabled;
Â  Â  Â  document.getElementById('addSlideBtn').disabled = !enabled;
Â  Â  Â  document.getElementById('addSlideForNewCustomerBtn').disabled = !enabled;
Â  Â  Â  document.getElementById('exportBtn').disabled = !enabled;
Â  Â  Â  document.getElementById('clearBtn').disabled = !enabled;
Â  Â  Â Â 
Â  Â  Â  if (enabled) {
Â  Â  Â  Â  document.getElementById('merchCode').placeholder = "Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„";
Â  Â  Â  } else {
Â  Â  Â  Â  document.getElementById('merchCode').placeholder = "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
Â  Â  Â  }
Â  Â  }

Â  Â  // Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† GitHub
Â  Â  const GITHUB_EXCEL_URL = "https://raw.githubusercontent.com/aicordinators-ux/presentation-app/main/Customers%202025.xlsx";

Â  Â  // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
Â  Â  async function loadSheetData() {
Â  Â  Â  try {
Â  Â  Â  Â  updateDataStatus('loading', 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡...');
Â  Â  Â  Â  toggleUIElements(false);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø§Ø³ØªØ®Ø¯Ø§Ù… CORS proxy Ù„ØªØ¬Ø§ÙˆØ² Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù€ 403
Â  Â  Â  Â  const proxyUrl = 'https://api.allorigins.win/raw?url=';
Â  Â  Â  Â  const targetUrl = encodeURIComponent(GITHUB_EXCEL_URL + '?t=' + new Date().getTime());
Â  Â  Â  Â  const url = proxyUrl + targetUrl;
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù†:', url);
Â  Â  Â  Â  const res = await fetch(url);
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!res.ok) {
Â  Â  Â  Â  Â  throw new Error(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª - Status: ${res.status}`);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const arrayBuffer = await res.arrayBuffer();
Â  Â  Â  Â  const workbook = XLSX.read(arrayBuffer, { type: 'array' });
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Ø§Ù„Ø´ÙŠØªØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:', workbook.SheetNames);
Â  Â  Â  Â Â 
Â  Â  Â  Â  const firstSheetName = workbook.SheetNames[0];
Â  Â  Â  Â  const worksheet = workbook.Sheets[firstSheetName];
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', worksheet['!ref']);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…ØµÙÙˆÙØ©
Â  Â  Â  Â  const allData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
Â  Â  Â  Â  console.log('Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', allData);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
Â  Â  Â  Â  let headers = [];
Â  Â  Â  Â  let dataStartRow = 0;
Â  Â  Â  Â Â 
Â  Â  Â  Â  for (let i = 0; i < Math.min(10, allData.length); i++) {
Â  Â  Â  Â  Â  const row = allData[i];
Â  Â  Â  Â  Â  if (Array.isArray(row)) {
Â  Â  Â  Â  Â  Â  const stringRow = row.map(cell => String(cell).toLowerCase());
Â  Â  Â  Â  Â  Â  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
Â  Â  Â  Â  Â  Â  const hasMerch = stringRow.some(cell => cell.includes('merch') || cell.includes('ÙƒÙˆØ¯'));
Â  Â  Â  Â  Â  Â  const hasCustomer = stringRow.some(cell => cell.includes('customer') || cell.includes('Ø¹Ù…ÙŠÙ„'));
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (hasMerch && hasCustomer) {
Â  Â  Â  Â  Â  Â  Â  headers = row.map(cell => String(cell));
Â  Â  Â  Â  Â  Â  Â  dataStartRow = i + 1;
Â  Â  Â  Â  Â  Â  Â  break;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
Â  Â  Â  Â  if (headers.length === 0) {
Â  Â  Â  Â  Â  headers = ['Merch Code', 'Acc-Code', 'Customer Name', 'Customer Address', 'Customer Type', 'Gov.', 'Notes'];
Â  Â  Â  Â  Â  dataStartRow = 0;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙƒØªØ´ÙØ©:', headers);
Â  Â  Â  Â  console.log('ØµÙ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', dataStartRow);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙƒØªØ´ÙØ©
Â  Â  Â  Â  const jsonData = XLSX.utils.sheet_to_json(worksheet, {Â 
Â  Â  Â  Â  Â  header: headers,
Â  Â  Â  Â  Â  range: dataStartRowÂ 
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  console.log('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†:', jsonData);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Â  Â  Â  Â  excelData = jsonData.map(row => {
Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  "Merch Code": String(row[headers[0]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Acc-Code": String(row[headers[1]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Customer Name": String(row[headers[2]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Customer Address": String(row[headers[3]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Customer Type": String(row[headers[4]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Gov.": String(row[headers[5]] || '').trim(),
Â  Â  Â  Â  Â  Â  "Notes": String(row[headers[6]] || '').trim()
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  }).filter(item => item["Merch Code"] !== '' && item["Merch Code"] !== undefined);

Â  Â  Â  Â  console.log('Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:', excelData);
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (excelData.length > 0) {
Â  Â  Â  Â  Â  updateDataStatus('success', `ØªÙ… ØªØ­Ù…ÙŠÙ„ ${excelData.length} Ø³Ø¬Ù„ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡`);
Â  Â  Â  Â  Â  showToast(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ${excelData.length} Ø³Ø¬Ù„ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡`, 'success');
Â  Â  Â  Â  Â  isDataLoaded = true;
Â  Â  Â  Â  Â  toggleUIElements(true);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  updateDataStatus('error', 'ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ÙˆÙ„ÙƒÙ† Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª');
Â  Â  Â  Â  Â  showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù ÙˆÙ„ÙƒÙ† Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª', 'warning');
Â  Â  Â  Â  Â  isDataLoaded = false;
Â  Â  Â  Â  Â  toggleUIElements(false);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  } catch (err) {
Â  Â  Â  Â  console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ±Ù‚Ø©:', err);
Â  Â  Â  Â  updateDataStatus('error', 'ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡');
Â  Â  Â  Â  showToast('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', 'error');
Â  Â  Â  Â  isDataLoaded = false;
Â  Â  Â  Â  toggleUIElements(false);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
Â  Â  Â  Â  document.getElementById('retryLoadBtn').style.display = 'block';
Â  Â  Â  }
Â  Â  }

Â  Â  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
Â  Â  window.addEventListener('load', function() {
Â  Â  Â  loadSheetData();
Â  Â  });

Â  Â  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
Â  Â  document.getElementById('retryLoadBtn').addEventListener('click', function() {
Â  Â  Â  this.style.display = 'none';
Â  Â  Â  loadSheetData();
Â  Â  });

Â  Â  // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙƒØªØ§Ø¨Ø© Merch Code
Â  Â  document.getElementById('merchCode').addEventListener('input', () => {
Â  Â  Â  if (!isDataLoaded) {
Â  Â  Â  Â  showToast('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...', 'warning');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const code = document.getElementById('merchCode').value.trim();
Â  Â  Â Â 
Â  Â  Â  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ù‚Ù„ ÙØ§Ø±ØºØŒ Ø§Ù…Ø³Ø­ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„
Â  Â  Â  if (code === '') {
Â  Â  Â  Â  clearCustomerData();
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Â  Â  Â  const match = findCustomerByCode(code);

Â  Â  Â  if (match) {
Â  Â  Â  Â  fillCustomerData(match);
Â  Â  Â  Â  currentCustomerCode = code;
Â  Â  Â  Â  updateCustomerInfo(match['Customer Name'], code);
Â  Â  Â  Â  showToast('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„', 'success');
Â  Â  Â  } else {
Â  Â  Â  Â  // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„
Â  Â  Â  Â  clearCustomerData();
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (code.length > 0) {
Â  Â  Â  Â  Â  showToast('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯', 'error');
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  });

Â  Â  // Ø¯Ø§Ù„Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„ÙƒÙˆØ¯ (ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù†ØµÙŠØ© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©)
Â  Â  function findCustomerByCode(code) {
Â  Â  Â  // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¯Ø®Ù„ Ù‡Ùˆ Ù†Øµ Ù†Ø¸ÙŠÙ
Â  Â  Â  const inputCode = String(code || '').trim();
Â  Â  Â Â 
Â  Â  Â  return excelData.find(item => {
Â  Â  Â  Â  // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥ÙƒØ³Ù„ Ù‡Ùˆ Ø£ÙŠØ¶Ø§Ù‹ Ù†Øµ Ù†Ø¸ÙŠÙ
Â  Â  Â  Â  const merchCode = String(item['Merch Code'] || '').trim();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙƒÙˆØ¯ ØªÙ…Ø§Ù…Ø§Ù‹ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ø£ØµÙØ§Ø± Ø§Ù„Ø¨Ø§Ø¯Ø¦Ø©
Â  Â  Â  Â  if (merchCode === inputCode) return true;
Â  Â  Â  Â Â 
Â  Â  Â  Â  return false;
Â  Â  Â  });
Â  Â  }

Â  Â  // Ø¯Ø§Ù„Ø© Ù„ØªØ¹Ø¨ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
Â  Â  function fillCustomerData(match) {
Â  Â  Â  document.getElementById('accCode').value = match['Acc-Code'] || '';
Â  Â  Â  document.getElementById('custName').value = match['Customer Name'] || '';
Â  Â  Â  document.getElementById('custAddress').value = match['Customer Address'] || '';
Â  Â  Â  document.getElementById('custType').value = match['Customer Type'] || '';
Â  Â  Â  document.getElementById('custGov').value = match['Gov.'] || '';
Â  Â  Â  document.getElementById('notes').value = match['Notes'] || '';
Â  Â  }

Â  Â  // Ø¯Ø§Ù„Ø© Ù„Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
Â  Â  function clearCustomerData() {
Â  Â  Â  document.getElementById('accCode').value = '';
Â  Â  Â  document.getElementById('custName').value = '';
Â  Â  Â  document.getElementById('custAddress').value = '';
Â  Â  Â  document.getElementById('custType').value = '';
Â  Â  Â  document.getElementById('custGov').value = '';
Â  Â  Â  document.getElementById('notes').value = '';
Â  Â  Â  currentCustomerCode = '';
Â  Â  Â  document.getElementById('customerInfo').style.display = 'none';
Â  Â  }

Â  Â  // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
Â  Â  function updateCustomerInfo(name, code) {
Â  Â  Â  document.getElementById('currentCustomerName').textContent = name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
Â  Â  Â  document.getElementById('currentCustomerCode').textContent = code || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
Â  Â  Â  document.getElementById('customerInfo').style.display = 'block';
Â  Â  }

Â  Â  // Ø¯Ø§Ù„Ø© Ù„Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ
Â  Â  function saveCurrentCustomerDataToSlide() {
Â  Â  Â  slides[currentIndex].customerData = {
Â  Â  Â  Â  merchCode: document.getElementById('merchCode').value || '',
Â  Â  Â  Â  accCode: document.getElementById('accCode').value || '',
Â  Â  Â  Â  custName: document.getElementById('custName').value || '',
Â  Â  Â  Â  custAddress: document.getElementById('custAddress').value || '',
Â  Â  Â  Â  custType: document.getElementById('custType').value || '',
Â  Â  Â  Â  custGov: document.getElementById('custGov').value || '',
Â  Â  Â  Â  notes: document.getElementById('notes').value || ''
Â  Â  Â  };
Â  Â  }

Â  Â  // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ
Â  Â  function loadCustomerDataFromSlide() {
Â  Â  Â  const customerData = slides[currentIndex].customerData;
Â  Â  Â  document.getElementById('merchCode').value = customerData.merchCode || '';
Â  Â  Â  document.getElementById('accCode').value = customerData.accCode || '';
Â  Â  Â  document.getElementById('custName').value = customerData.custName || '';
Â  Â  Â  document.getElementById('custAddress').value = customerData.custAddress || '';
Â  Â  Â  document.getElementById('custType').value = customerData.custType || '';
Â  Â  Â  document.getElementById('custGov').value = customerData.custGov || '';
Â  Â  Â  document.getElementById('notes').value = customerData.notes || '';
Â  Â  Â Â 
Â  Â  Â  // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
Â  Â  Â  if (customerData.merchCode) {
Â  Â  Â  Â  currentCustomerCode = customerData.merchCode;
Â  Â  Â  Â  updateCustomerInfo(customerData.custName, customerData.merchCode);
Â  Â  Â  } else {
Â  Â  Â  Â  clearCustomerData();
Â  Â  Â  }
Â  Â  }

Â  Â  // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙˆØ±Ø©
Â  Â  function openImagePicker(idx) {
Â  Â  Â  pendingIdx = idx;
Â  Â  Â Â 
Â  Â  Â  const modal = document.createElement('div');
Â  Â  Â  modal.className = 'modal';
Â  Â  Â  modal.innerHTML = `
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  <h3 style="margin-bottom:10px;">Ø§Ø®ØªØ± Ù…ØµØ¯Ø± Ø§Ù„ØµÙˆØ±Ø©</h3>
Â  Â  Â  Â  Â  <div class="modal-buttons">
Â  Â  Â  Â  Â  Â  <button id="camBtn" style="background:#0b71eb;color:#fff;border:none;padding:10px 14px;border-radius:8px;margin:6px;cursor:pointer;">ğŸ“· Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
Â  Â  Â  Â  Â  Â  <button id="galleryBtn" style="background:#2c8a2c;color:#fff;border:none;padding:10px 14px;border-radius:8px;margin:6px;cursor:pointer;">ğŸ–¼ï¸ Ø§Ù„Ù…Ø¹Ø±Ø¶</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  Â Â 
Â  Â  Â  document.body.appendChild(modal);

Â  Â  Â  modal.querySelector('#camBtn').addEventListener('click', () => {
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  Â  const camInput = document.createElement('input');
Â  Â  Â  Â  camInput.type = 'file';
Â  Â  Â  Â  camInput.accept = 'image/*';
Â  Â  Â  Â  camInput.capture = 'camera';
Â  Â  Â  Â  camInput.style.display = 'none';
Â  Â  Â  Â  camInput.addEventListener('change', async e => {
Â  Â  Â  Â  Â  const file = e.target.files && e.target.files[0];
Â  Â  Â  Â  Â  if (file) await handleSelectedFile(file);
Â  Â  Â  Â  Â  camInput.remove();
Â  Â  Â  Â  });
Â  Â  Â  Â  document.body.appendChild(camInput);
Â  Â  Â  Â  camInput.click();
Â  Â  Â  });

Â  Â  Â  modal.querySelector('#galleryBtn').addEventListener('click', () => {
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  Â  hiddenInput.value = '';
Â  Â  Â  Â  hiddenInput.click();
Â  Â  Â  });

Â  Â  Â  modal.addEventListener('click', e => {
Â  Â  Â  Â  if (e.target === modal) {
Â  Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  }

Â  Â  async function handleSelectedFile(file) {
Â  Â  Â  if (!file) return;
Â  Â  Â Â 
Â  Â  Â  showToast('Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©...', 'info');
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  const dataUrl = await fileToDataURL(file);
Â  Â  Â  Â  const resized = await resizeDataUrl(dataUrl, MAX_WIDTH, 0.8);
Â  Â  Â  Â  slides[currentIndex].images[pendingIdx] = resized;
Â  Â  Â  Â  hasUnsavedChanges = true;
Â  Â  Â  Â  renderCurrentSlide();
Â  Â  Â  Â  showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error(error);
Â  Â  Â  Â  showToast('ÙØ´Ù„ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©', 'error');
Â  Â  Â  }
Â  Â  }

Â  Â  function fileToDataURL(file) {
Â  Â  Â  return new Promise((resolve, reject) => {
Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  reader.onload = () => resolve(reader.result);
Â  Â  Â  Â  reader.onerror = reject;
Â  Â  Â  Â  reader.readAsDataURL(file);
Â  Â  Â  });
Â  Â  }

Â  Â  function resizeDataUrl(dataUrl, maxWidth, quality = 0.85) {
Â  Â  Â  return new Promise((resolve, reject) => {
Â  Â  Â  Â  const img = new Image();
Â  Â  Â  Â  img.onload = () => {
Â  Â  Â  Â  Â  const ratio = img.width / img.height;
Â  Â  Â  Â  Â  const width = Math.min(maxWidth, img.width);
Â  Â  Â  Â  Â  const height = Math.round(width / ratio);
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const canvas = document.createElement('canvas');
Â  Â  Â  Â  Â  canvas.width = width;
Â  Â  Â  Â  Â  canvas.height = height;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const ctx = canvas.getContext('2d');
Â  Â  Â  Â  Â  ctx.drawImage(img, 0, 0, width, height);
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  resolve(canvas.toDataURL('image/jpeg', quality));
Â  Â  Â  Â  };
Â  Â  Â  Â  img.onerror = () => reject(new Error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©'));
Â  Â  Â  Â  img.src = dataUrl;
Â  Â  Â  });
Â  Â  }

Â  Â  hiddenInput.addEventListener('change', async e => {
Â  Â  Â  const file = e.target.files && e.target.files[0];
Â  Â  Â  await handleSelectedFile(file);
Â  Â  });

Â  Â  function renderSlides() {
Â  Â  Â  slidesListEl.innerHTML = '';
Â  Â  Â  slides.forEach((slide, index) => {
Â  Â  Â  Â  const thumb = document.createElement('div');
Â  Â  Â  Â  thumb.className = 'slide-thumb' + (index === currentIndex ? ' active' : '');
Â  Â  Â  Â Â 
Â  Â  Â  Â  const slideNumber = document.createElement('div');
Â  Â  Â  Â  slideNumber.textContent = `Ø³Ù„Ø§ÙŠØ¯ ${index + 1}`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const customerName = document.createElement('div');
Â  Â  Â  Â  customerName.className = 'slide-customer';
Â  Â  Â  Â  customerName.textContent = slide.customerData.custName || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù…ÙŠÙ„';
Â  Â  Â  Â Â 
Â  Â  Â  Â  thumb.appendChild(slideNumber);
Â  Â  Â  Â  thumb.appendChild(customerName);
Â  Â  Â  Â Â 
Â  Â  Â  Â  thumb.addEventListener('click', () => {
Â  Â  Â  Â  Â  // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
Â  Â  Â  Â  Â  saveCurrentCustomerDataToSlide();
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
Â  Â  Â  Â  Â  currentIndex = index;
Â  Â  Â  Â  Â  renderCurrentSlide();
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
Â  Â  Â  Â  Â  loadCustomerDataFromSlide();
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  slidesListEl.appendChild(thumb);
Â  Â  Â  });
Â  Â  }

Â  Â  function renderCurrentSlide() {
Â  Â  Â  placeholdersEl.innerHTML = '';
Â  Â  Â  slides[currentIndex].images.forEach((data, index) => {
Â  Â  Â  Â  const placeholder = document.createElement('div');
Â  Â  Â  Â  placeholder.className = 'ph';
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (data) {
Â  Â  Â  Â  Â  const img = document.createElement('img');
Â  Â  Â  Â  Â  img.src = data;
Â  Â  Â  Â  Â  placeholder.appendChild(img);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  const label = document.createElement('div');
Â  Â  Â  Â  Â  label.className = 'label';
Â  Â  Â  Â  Â  label.textContent = 'Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©';
Â  Â  Â  Â  Â  placeholder.appendChild(label);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  placeholder.addEventListener('click', () => openImagePicker(index));
Â  Â  Â  Â  placeholdersEl.appendChild(placeholder);
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  renderSlides();
Â  Â  }

Â  Â  // Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
Â  Â  document.getElementById('addSlideBtn').addEventListener('click', () => {
Â  Â  Â  if (!isDataLoaded) {
Â  Â  Â  Â  showToast('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯', 'error');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if (!currentCustomerCode) {
Â  Â  Â  Â  showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'error');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
Â  Â  Â  slides.push({
Â  Â  Â  Â  images: [null, null, null],
Â  Â  Â  Â  customerData: {
Â  Â  Â  Â  Â  merchCode: document.getElementById('merchCode').value || '',
Â  Â  Â  Â  Â  accCode: document.getElementById('accCode').value || '',
Â  Â  Â  Â  Â  custName: document.getElementById('custName').value || '',
Â  Â  Â  Â  Â  custAddress: document.getElementById('custAddress').value || '',
Â  Â  Â  Â  Â  custType: document.getElementById('custType').value || '',
Â  Â  Â  Â  Â  custGov: document.getElementById('custGov').value || '',
Â  Â  Â  Â  Â  notes: document.getElementById('notes').value || ''
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  currentIndex = slides.length - 1;
Â  Â  Â  hasUnsavedChanges = true;
Â  Â  Â  renderCurrentSlide();
Â  Â  Â  showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ', 'success');
Â  Â  });

Â  Â  // Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù„Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
Â  Â  document.getElementById('addSlideForNewCustomerBtn').addEventListener('click', () => {
Â  Â  Â  if (!isDataLoaded) {
Â  Â  Â  Â  showToast('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯', 'error');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const modal = document.createElement('div');
Â  Â  Â  modal.className = 'modal';
Â  Â  Â  modal.innerHTML = `
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  <h3 style="margin-bottom:10px;">Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ù„Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
Â  Â  Â  Â  Â  <p style="margin-bottom:15px;font-size:14px;color:#666;">Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯:</p>
Â  Â  Â  Â  Â  <input type="text" id="newCustomerCodeInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„" style="padding:8px;width:100%;box-sizing:border-box;border-radius:6px;border:1px solid #ccc;margin-bottom:15px;">
Â  Â  Â  Â  Â  <div class="modal-buttons">
Â  Â  Â  Â  Â  Â  <button id="cancelNewCustomerBtn" style="background:#888;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;">Ø¥Ù„ØºØ§Ø¡</button>
Â  Â  Â  Â  Â  Â  <button id="confirmNewCustomerBtn" style="background:#2c8a2c;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;">Ù…ÙˆØ§ÙÙ‚</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  Â Â 
Â  Â  Â  document.body.appendChild(modal);
Â  Â  Â Â 
Â  Â  Â  const newCustomerCodeInput = document.getElementById('newCustomerCodeInput');
Â  Â  Â  newCustomerCodeInput.focus();
Â  Â  Â Â 
Â  Â  Â  // Ø¥Ø¶Ø§ÙØ© event listeners Ù„Ù„Ø£Ø²Ø±Ø§Ø±
Â  Â  Â  document.getElementById('cancelNewCustomerBtn').addEventListener('click', () => {
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  document.getElementById('confirmNewCustomerBtn').addEventListener('click', () => {
Â  Â  Â  Â  const newCode = newCustomerCodeInput.value.trim();
Â  Â  Â  Â  if (!newCode) {
Â  Â  Â  Â  Â  showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„', 'error');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const match = findCustomerByCode(newCode);
Â  Â  Â  Â  if (!match) {
Â  Â  Â  Â  Â  showToast('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯', 'error');
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
Â  Â  Â  Â  saveCurrentCustomerDataToSlide();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
Â  Â  Â  Â  document.getElementById('merchCode').value = newCode;
Â  Â  Â  Â  fillCustomerData(match);
Â  Â  Â  Â  currentCustomerCode = newCode;
Â  Â  Â  Â  updateCustomerInfo(match['Customer Name'], newCode);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯
Â  Â  Â  Â  slides.push({
Â  Â  Â  Â  Â  images: [null, null, null],
Â  Â  Â  Â  Â  customerData: {
Â  Â  Â  Â  Â  Â  merchCode: newCode,
Â  Â  Â  Â  Â  Â  accCode: match['Acc-Code'] || '',
Â  Â  Â  Â  Â  Â  custName: match['Customer Name'] || '',
Â  Â  Â  Â  Â  Â  custAddress: match['Customer Address'] || '',
Â  Â  Â  Â  Â  Â  custType: match['Customer Type'] || '',
Â  Â  Â  Â  Â  Â  custGov: match['Gov.'] || '',
Â  Â  Â  Â  Â  Â  notes: match['Notes'] || ''
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  currentIndex = slides.length - 1;
Â  Â  Â  Â  hasUnsavedChanges = true;
Â  Â  Â  Â  renderCurrentSlide();
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  Â  showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø§ÙŠØ¯ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¹Ù…ÙŠÙ„: ' + match['Customer Name'], 'success');
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter Ù„Ù„ØªØ£ÙƒÙŠØ¯
Â  Â  Â  newCustomerCodeInput.addEventListener('keypress', (e) => {
Â  Â  Â  Â  if (e.key === 'Enter') {
Â  Â  Â  Â  Â  document.getElementById('confirmNewCustomerBtn').click();
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  }

Â  Â  // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ
Â  Â  document.getElementById('exportBtn').addEventListener('click', async () => {
Â  Â  Â  saveCurrentCustomerDataToSlide(); // Ø­ÙØ¸ Ø¢Ø®Ø± ØªØ¹Ø¯ÙŠÙ„Ø§Øª
Â  Â  Â  if (slides.length === 0 || slides.every(s => s.customerData.merchCode === '' && s.images.every(img => img === null))) {
Â  Â  Â  Â  showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const loadingOverlay = document.createElement('div');
Â  Â  Â  loadingOverlay.className = 'loading-overlay';
Â  Â  Â  loadingOverlay.innerHTML = '<div class="loading-spinner"></div><div>Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ø¹Ø±Ø¶...</div>';
Â  Â  Â  document.body.appendChild(loadingOverlay);
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  const pres = new PptxGenJS();
Â  Â  Â  Â  pres.layout = 'LAYOUT_WIDE'; // 16:9

Â  Â  Â  Â  for (let i = 0; i < slides.length; i++) {
Â  Â  Â  Â  Â  const slideData = slides[i];
Â  Â  Â  Â  Â  const customer = slideData.customerData;

Â  Â  Â  Â  Â  // ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª Ø§Ù„ÙØ§Ø±ØºØ© ØªÙ…Ø§Ù…Ù‹Ø§
Â  Â  Â  Â  Â  if (customer.merchCode === '' && slideData.images.every(img => img === null)) continue;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const slide = pres.addSlide();
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØµÙˆØµ (Ù„ØªØ¯Ø¹Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)
Â  Â  Â  Â  Â  const baseTextOpts = {
Â  Â  Â  Â  Â  Â  fontFace: 'Tahoma',
Â  Â  Â  Â  Â  Â  color: '000000',
Â  Â  Â  Â  Â  Â  align: 'right',
Â  Â  Â  Â  Â  Â  isRTL: true,
Â  Â  Â  Â  Â  Â  wrap: true
Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  // 1. Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ (Merch Code ÙˆØ§Ù„Ø§Ø³Ù…)
Â  Â  Â  Â  Â  slide.addText(
Â  Â  Â  Â  Â  Â  `ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.merchCode} | Ø§Ù„Ø§Ø³Ù…: ${customer.custName}`,
Â  Â  Â  Â  Â  Â  { ...baseTextOpts, x: 0.5, y: 0.1, w: 12.5, h: 0.5, fontSize: 18, bold: true, color: '0B71EB' }
Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  // 2. Ø¥Ø¶Ø§ÙØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ Ø´Ø±ÙŠØ· Ø³ÙÙ„ÙŠ
Â  Â  Â  Â  Â  slide.addText(
Â  Â  Â  Â  Â  Â  [
Â  Â  Â  Â  Â  Â  Â  { text: `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${customer.custAddress}`, options: { breakLine: true } },
Â  Â  Â  Â  Â  Â  Â  { text: `Ø§Ù„Ù†ÙˆØ¹: ${customer.custType}`, options: { breakLine: true } },
Â  Â  Â  Â  Â  Â  Â  { text: `Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${customer.custGov}`, options: { breakLine: true } },
Â  Â  Â  Â  Â  Â  Â  { text: `Acc-Code: ${customer.accCode}` }
Â  Â  Â  Â  Â  Â  ],
Â  Â  Â  Â  Â  Â  { 
Â  Â  Â  Â  Â  Â  Â  ...baseTextOpts, 
Â  Â  Â  Â  Â  Â  Â  x: 0.5, y: 6.8, w: 12.5, h: 0.5, 
Â  Â  Â  Â  Â  Â  Â  fontSize: 10, 
Â  Â  Â  Â  Â  Â  Â  color: '666666',
Â  Â  Â  Â  Â  Â  Â  fill: { color: 'E8F0FE' }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  // 3. Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
Â  Â  Â  Â  Â  if (customer.notes) {
Â  Â  Â  Â  Â  Â  slide.addText(
Â  Â  Â  Â  Â  Â  Â  `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${customer.notes}`,
Â  Â  Â  Â  Â  Â  Â  { ...baseTextOpts, x: 0.5, y: 6.3, w: 12.5, h: 0.4, fontSize: 12, color: 'E53935' }
Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  // 4. Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ± (Ø¨Ø§ÙØªØ±Ø§Ø¶ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ 3 ØµÙˆØ± Ø£ÙÙ‚ÙŠØ©)
Â  Â  Â  Â  Â  const imgWidth = 4.2;
Â  Â  Â  Â  Â  const imgHeight = 4.7;
Â  Â  Â  Â  Â  const imgY = 1.3;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // ÙŠØªÙ… Ø±Ø³Ù… Ø§Ù„ØµÙˆØ± Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±
Â  Â  Â  Â  Â  const xPos = [9.0, 4.7, 0.4]; 

Â  Â  Â  Â  Â  slideData.images.forEach((imgBase64, index) => {
Â  Â  Â  Â  Â  Â  if (imgBase64) {
Â  Â  Â  Â  Â  Â  Â  slide.addImage({
Â  Â  Â  Â  Â  Â  Â  Â  data: imgBase64,
Â  Â  Â  Â  Â  Â  Â  Â  x: xPos[index],
Â  Â  Â  Â  Â  Â  Â  Â  y: imgY,
Â  Â  Â  Â  Â  Â  Â  Â  w: imgWidth,
Â  Â  Â  Â  Â  Â  Â  Â  h: imgHeight,
Â  Â  Â  Â  Â  Â  Â  Â  sizing: { type: 'contain', w: imgWidth, h: imgHeight }
Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  await pres.writeFile({ fileName: `Presentation-${Date.now()}.pptx` });
Â  Â  Â  Â  showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ù†Ø¬Ø§Ø­!', 'success', 5000);
Â  Â  Â  Â  hasUnsavedChanges = false;
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±:', error);
Â  Â  Â  Â  showToast('ÙØ´Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±: ' + error.message, 'error', 7000);
Â  Â  Â  } finally {
Â  Â  Â  Â  document.body.removeChild(loadingOverlay);
Â  Â  Â  }
Â  Â  });

Â  Â  // ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª
Â  Â  document.getElementById('clearBtn').addEventListener('click', () => {
Â  Â  Â  const modal = document.createElement('div');
Â  Â  Â  modal.className = 'modal';
Â  Â  Â  modal.innerHTML = `
Â  Â  Â  Â  <div class="modal-content">
Â  Â  Â  Â  Â  <h3 style="margin-bottom:10px;">ØªØ£ÙƒÙŠØ¯ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª</h3>
Â  Â  Â  Â  Â  <p style="margin-bottom:15px;font-size:14px;">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§ØªØŸ</p>
Â  Â  Â  Â  Â  <div class="modal-buttons">
Â  Â  Â  Â  Â  Â  <button id="cancelClearBtn" style="background:#888;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;">Ø¥Ù„ØºØ§Ø¡</button>
Â  Â  Â  Â  Â  Â  <button id="confirmClearBtn" style="background:#e53935;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³Ø­</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  Â Â 
Â  Â  Â  document.body.appendChild(modal);
Â  Â  Â Â 
Â  Â  Â  document.getElementById('cancelClearBtn').addEventListener('click', () => {
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  });
Â  Â  Â Â 
Â  Â  Â  document.getElementById('confirmClearBtn').addEventListener('click', () => {
Â  Â  Â  Â  slides = [{
Â  Â  Â  Â  Â  images: [null, null, null],
Â  Â  Â  Â  Â  customerData: {
Â  Â  Â  Â  Â  Â  merchCode: '',
Â  Â  Â  Â  Â  Â  accCode: '',
Â  Â  Â  Â  Â  Â  custName: '',
Â  Â  Â  Â  Â  Â  custAddress: '',
Â  Â  Â  Â  Â  Â  custType: '',
Â  Â  Â  Â  Â  Â  custGov: '',
Â  Â  Â  Â  Â  Â  notes: ''
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }];
Â  Â  Â  Â  currentIndex = 0;
Â  Â  Â  Â  hasUnsavedChanges = false;
Â  Â  Â  Â  renderCurrentSlide();
Â  Â  Â  Â  clearCustomerData();
Â  Â  Â  Â  showToast('ØªÙ… ØªÙØ±ÙŠØº Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
Â  Â  Â  Â  document.body.removeChild(modal);
Â  Â  Â  });
Â  Â  });

Â  Â  // Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
Â  Â  document.getElementById('refreshDataBtn').addEventListener('click', loadSheetData);
Â  Â  
Â  Â  // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø±Ø¶ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
Â  Â  window.addEventListener('load', renderCurrentSlide);
Â  </script>
</body>
</html>
